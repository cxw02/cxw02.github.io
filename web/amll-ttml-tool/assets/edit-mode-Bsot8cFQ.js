import{m as oe,d as de,g as xe,l as ee,A as fe,j as i,a8 as Q,G as ge,z as se,C as re,H as ye,e as ue,a as ae,u as ce,f as me,k as be,s as he,J as pe,q as je,b1 as we}from"./index-Bue90L20.js";import{R as X,a as Le}from"./common-ChM43Ux2.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(s,t){return this.cache.has(s)?this.cache.get(s):(this.cache.set(s,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(s,t){return this.cache.has(s)?this.cache.get(s):(this.cache.set(s,t),t)}};const Z=Symbol("multiple-values");function $(s){const t=de.c(37),{label:e,isWordField:a,fieldName:l,formatter:v,parser:N,textFieldStyle:n}=s,[V,j]=oe.useState(void 0),[C,_]=oe.useState("");let R;R=a?be:he;const h=R,W=ue(ee),{t:g}=fe();let k,w;t[0]!==l||t[1]!==v||t[2]!==a||t[3]!==h?(w=ae(f=>{const S=f(h),I=f(ee);if(S.size===0)return;if(a){const A=S,Y=new Set;for(const P of I.lyricLines)for(const D of P.words)A.has(D.id)&&Y.add(D[l]);return Y.size===1?v(Y.values().next().value):Z}const G=S,T=new Set;for(const A of I.lyricLines)G.has(A.id)&&T.add(A[l]);return T.size===1?v(T.values().next().value):Z}),t[0]=l,t[1]=v,t[2]=a,t[3]=h,t[4]=w):w=t[4],k=w;const r=ce(k),p=me();let u;t[5]!==r||t[6]!==W||t[7]!==l||t[8]!==a||t[9]!==h||t[10]!==N||t[11]!==p?(u=f=>{try{const S=p.get(h),I=N(f);W(G=>{for(const T of G.lyricLines)if(a)for(const A of T.words)S.has(A.id)&&(A[l]=I);else S.has(T.id)&&(T[l]=I);return G})}catch{typeof r=="string"&&j(r)}},t[5]=r,t[6]=W,t[7]=l,t[8]=a,t[9]=h,t[10]=N,t[11]=p,t[12]=u):u=t[12];const m=u;let o,b;t[13]!==r||t[14]!==g?(o=()=>{r===Z?(j(""),_(g("ribbonBar.editMode.multipleValues","多个值..."))):(j(r),_(""))},b=[r,g],t[13]=r,t[14]=g,t[15]=o,t[16]=b):(o=t[15],b=t[16]),oe.useLayoutEffect(o,b);let c;t[17]!==e?(c=i.jsx(pe,{wrap:"nowrap",size:"1",children:e}),t[17]=e,t[18]=c):c=t[18];let d;t[19]!==n?(d={width:"8em",...n},t[19]=n,t[20]=d):d=t[20];const x=V??"",L=V===void 0;let B;t[21]===Symbol.for("react.memo_cache_sentinel")?(B=f=>j(f.currentTarget.value),t[21]=B):B=t[21];let M;t[22]!==m?(M=f=>{f.key==="Enter"&&m(f.currentTarget.value)},t[22]=m,t[23]=M):M=t[23];let y;t[24]!==r||t[25]!==m?(y=f=>{f.currentTarget.value!==r&&m(f.currentTarget.value)},t[24]=r,t[25]=m,t[26]=y):y=t[26];let z;t[27]!==C||t[28]!==L||t[29]!==M||t[30]!==y||t[31]!==d||t[32]!==x?(z=i.jsx(je,{size:"1",style:d,value:x,placeholder:C,disabled:L,onChange:B,onKeyDown:M,onBlur:y}),t[27]=C,t[28]=L,t[29]=M,t[30]=y,t[31]=d,t[32]=x,t[33]=z):z=t[33];let E;return t[34]!==z||t[35]!==c?(E=i.jsxs(i.Fragment,{children:[c,z]}),t[34]=z,t[35]=c,t[36]=E):E=t[36],E}function ne(s){const t=de.c(21),{label:e,isWordField:a,fieldName:l,defaultValue:v}=s;let N;N=a?be:he;const n=N,V=ue(ee),j=me();let C,_;t[0]!==l||t[1]!==a||t[2]!==n?(_=ae(o=>{const b=o(n),c=o(ee);if(b.size){if(a){const L=b,B=new Set;for(const M of c.lyricLines)for(const y of M.words)L.has(y.id)&&B.add(y[l]);return B.size===1?B.values().next().value:Z}const d=b,x=new Set;for(const L of c.lyricLines)d.has(L.id)&&x.add(L[l]);return x.size===1?x.values().next().value:Z}}),t[0]=l,t[1]=a,t[2]=n,t[3]=_):_=t[3],C=_;const h=ce(C);let W,g;t[4]!==n?(g=ae(o=>o(n).size===0),t[4]=n,t[5]=g):g=t[5],W=g;const w=ce(W);let F;t[6]!==e?(F=i.jsx(pe,{wrap:"nowrap",size:"1",children:e}),t[6]=e,t[7]=F):F=t[7];const r=h?h===Z?"indeterminate":h:v;let p;t[8]!==V||t[9]!==l||t[10]!==a||t[11]!==n||t[12]!==j?(p=o=>{o!=="indeterminate"&&V(b=>{const c=j.get(n);for(const d of b.lyricLines)if(a)for(const x of d.words)c.has(x.id)&&(x[l]=o);else c.has(d.id)&&(d[l]=o);return b})},t[8]=V,t[9]=l,t[10]=a,t[11]=n,t[12]=j,t[13]=p):p=t[13];let u;t[14]!==w||t[15]!==r||t[16]!==p?(u=i.jsx(we,{disabled:w,checked:r,onCheckedChange:p}),t[14]=w,t[15]=r,t[16]=p,t[17]=u):u=t[17];let m;return t[18]!==F||t[19]!==u?(m=i.jsxs(i.Fragment,{children:[F,u]}),t[18]=F,t[19]=u,t[20]=m):m=t[20],m}const Ve=oe.forwardRef((s,t)=>{const e=de.c(112),a=xe(ee),{t:l}=fe();let v;e[0]!==l?(v=l("ribbonBar.editMode.new","新建"),e[0]=l,e[1]=v):v=e[1];let N;e[2]!==a?(N=()=>a(Be),e[2]=a,e[3]=N):N=e[3];let n;e[4]!==l?(n=l("ribbonBar.editMode.lyricLine","歌词行"),e[4]=l,e[5]=n):n=e[5];let V;e[6]!==N||e[7]!==n?(V=i.jsx(Q,{columns:"1",gap:"1",gapY:"1",flexGrow:"1",align:"center",children:i.jsx(ge,{size:"1",variant:"soft",onClick:N,children:n})}),e[6]=N,e[7]=n,e[8]=V):V=e[8];let j;e[9]!==v||e[10]!==V?(j=i.jsx(X,{label:v,children:V}),e[9]=v,e[10]=V,e[11]=j):j=e[11];let C;e[12]!==l?(C=l("ribbonBar.editMode.timing","行时间戳"),e[12]=l,e[13]=C):C=e[13];let _;e[14]!==l?(_=l("ribbonBar.editMode.startTime","起始时间"),e[14]=l,e[15]=_):_=e[15];let R;e[16]!==_?(R=i.jsx($,{label:_,fieldName:"startTime",parser:re,formatter:se}),e[16]=_,e[17]=R):R=e[17];let h;e[18]!==l?(h=l("ribbonBar.editMode.endTime","结束时间"),e[18]=l,e[19]=h):h=e[19];let W;e[20]!==h?(W=i.jsx($,{label:h,fieldName:"endTime",parser:re,formatter:se}),e[20]=h,e[21]=W):W=e[21];let g;e[22]!==R||e[23]!==W?(g=i.jsxs(Q,{columns:"0fr 1fr",gap:"2",gapY:"1",flexGrow:"1",align:"center",children:[R,W]}),e[22]=R,e[23]=W,e[24]=g):g=e[24];let k;e[25]!==g||e[26]!==C?(k=i.jsx(X,{label:C,children:g}),e[25]=g,e[26]=C,e[27]=k):k=e[27];let w;e[28]!==l?(w=l("ribbonBar.editMode.lineProperties","行属性"),e[28]=l,e[29]=w):w=e[29];let F;e[30]!==l?(F=l("ribbonBar.editMode.bgLyric","背景歌词"),e[30]=l,e[31]=F):F=e[31];let r;e[32]!==F?(r=i.jsx(ne,{label:F,isWordField:!1,fieldName:"isBG",defaultValue:!1}),e[32]=F,e[33]=r):r=e[33];let p;e[34]!==l?(p=l("ribbonBar.editMode.duetLyric","对唱歌词"),e[34]=l,e[35]=p):p=e[35];let u;e[36]!==p?(u=i.jsx(ne,{label:p,isWordField:!1,fieldName:"isDuet",defaultValue:!1}),e[36]=p,e[37]=u):u=e[37];let m;e[38]!==l?(m=l("ribbonBar.editMode.ignoreSync","忽略打轴"),e[38]=l,e[39]=m):m=e[39];let o;e[40]!==m?(o=i.jsx(ne,{label:m,isWordField:!1,fieldName:"ignoreSync",defaultValue:!1}),e[40]=m,e[41]=o):o=e[41];let b;e[42]!==r||e[43]!==u||e[44]!==o?(b=i.jsxs(Q,{columns:"0fr 1fr",gap:"2",gapY:"1",flexGrow:"1",align:"center",children:[r,u,o]}),e[42]=r,e[43]=u,e[44]=o,e[45]=b):b=e[45];let c;e[46]!==w||e[47]!==b?(c=i.jsx(X,{label:w,children:b}),e[46]=w,e[47]=b,e[48]=c):c=e[48];let d;e[49]!==l?(d=l("ribbonBar.editMode.timing","词时间戳"),e[49]=l,e[50]=d):d=e[50];let x;e[51]!==l?(x=l("ribbonBar.editMode.startTime","起始时间"),e[51]=l,e[52]=x):x=e[52];let L;e[53]!==x?(L=i.jsx($,{label:x,fieldName:"startTime",isWordField:!0,parser:re,formatter:se}),e[53]=x,e[54]=L):L=e[54];let B;e[55]!==l?(B=l("ribbonBar.editMode.endTime","结束时间"),e[55]=l,e[56]=B):B=e[56];let M;e[57]!==B?(M=i.jsx($,{label:B,fieldName:"endTime",isWordField:!0,parser:re,formatter:se}),e[57]=B,e[58]=M):M=e[58];let y;e[59]!==l?(y=l("ribbonBar.editMode.emptyBeatCount","空拍数量"),e[59]=l,e[60]=y):y=e[60];let z;e[61]!==y?(z=i.jsx($,{label:y,fieldName:"emptyBeat",isWordField:!0,parser:Number.parseInt,formatter:String}),e[61]=y,e[62]=z):z=e[62];let E;e[63]!==L||e[64]!==M||e[65]!==z?(E=i.jsxs(Q,{columns:"0fr 1fr",gap:"2",gapY:"1",flexGrow:"1",align:"center",children:[L,M,z]}),e[63]=L,e[64]=M,e[65]=z,e[66]=E):E=e[66];let f;e[67]!==d||e[68]!==E?(f=i.jsx(X,{label:d,children:E}),e[67]=d,e[68]=E,e[69]=f):f=e[69];let S;e[70]!==l?(S=l("ribbonBar.editMode.wordProperties","单词属性"),e[70]=l,e[71]=S):S=e[71];let I;e[72]!==l?(I=l("ribbonBar.editMode.wordContent","单词内容"),e[72]=l,e[73]=I):I=e[73];let G;e[74]!==I?(G=i.jsx($,{label:I,fieldName:"word",isWordField:!0,parser:Me,formatter:_e}),e[74]=I,e[75]=G):G=e[75];let T;e[76]!==l?(T=l("ribbonBar.editMode.obscene","不雅用语"),e[76]=l,e[77]=T):T=e[77];let A;e[78]!==T?(A=i.jsx(ne,{label:T,isWordField:!0,fieldName:"obscene",defaultValue:!1}),e[78]=T,e[79]=A):A=e[79];let Y;e[80]!==G||e[81]!==A?(Y=i.jsxs(Q,{columns:"0fr 1fr",gap:"2",gapY:"1",flexGrow:"1",align:"center",children:[G,A]}),e[80]=G,e[81]=A,e[82]=Y):Y=e[82];let P;e[83]!==S||e[84]!==Y?(P=i.jsx(X,{label:S,children:Y}),e[83]=S,e[84]=Y,e[85]=P):P=e[85];let D;e[86]!==l?(D=l("ribbonBar.editMode.secondaryContent","次要内容"),e[86]=l,e[87]=D):D=e[87];let U;e[88]!==l?(U=l("ribbonBar.editMode.translatedLyric","翻译歌词"),e[88]=l,e[89]=U):U=e[89];let te;e[90]===Symbol.for("react.memo_cache_sentinel")?(te={width:"20em"},e[90]=te):te=e[90];let q;e[91]!==U?(q=i.jsx($,{label:U,fieldName:"translatedLyric",parser:Fe,formatter:Se,textFieldStyle:te}),e[91]=U,e[92]=q):q=e[92];let H;e[93]!==l?(H=l("ribbonBar.editMode.romanLyric","音译歌词"),e[93]=l,e[94]=H):H=e[94];let le;e[95]===Symbol.for("react.memo_cache_sentinel")?(le={width:"20em"},e[95]=le):le=e[95];let J;e[96]!==H?(J=i.jsx($,{label:H,fieldName:"romanLyric",parser:Te,formatter:Ae,textFieldStyle:le}),e[96]=H,e[97]=J):J=e[97];let K;e[98]!==q||e[99]!==J?(K=i.jsxs(Q,{columns:"0fr 1fr",gap:"2",gapY:"1",flexGrow:"1",align:"center",children:[q,J]}),e[98]=q,e[99]=J,e[100]=K):K=e[100];let O;e[101]!==D||e[102]!==K?(O=i.jsx(X,{label:D,children:K}),e[101]=D,e[102]=K,e[103]=O):O=e[103];let ie;return e[104]!==t||e[105]!==k||e[106]!==c||e[107]!==f||e[108]!==P||e[109]!==j||e[110]!==O?(ie=i.jsxs(Le,{ref:t,children:[j,k,c,f,P,O]}),e[104]=t,e[105]=k,e[106]=c,e[107]=f,e[108]=P,e[109]=j,e[110]=O,e[111]=ie):ie=e[111],ie});function Be(s){return{...s,lyricLines:[...s.lyricLines,ye()]}}function Me(s){return s}function _e(s){return s}function Fe(s){return s}function Se(s){return s}function Te(s){return s}function Ae(s){return s}export{Ve as EditModeRibbonBar,Ve as default};
//# sourceMappingURL=edit-mode-Bsot8cFQ.js.map
