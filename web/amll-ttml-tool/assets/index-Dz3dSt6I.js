import{c as ze,a as oe,r as yr,b as wr,d as ye,u as P,s as pe,e as ae,l as be,j as l,R as ot,f as Je,g as it,h as Kt,i as Ut,k as fe,n as st,m as Z,t as ct,o as br,T as re,L as Bt,p as Te,q as lt,v as at,S as dt,w as ft,x as Lr,y as Jt,z as ke,A as Qt,B as xt,P as xr,C as Zt,D as Ye,E as Tr,F as er,G as At,H as $t,I as Me,J as Ke,K as vr}from"./index-Bue90L20.js";const Tt=ze("AddFilled","1em",["M10 2.25c.41 0 .75.34.75.75v6.25H17a.75.75 0 0 1 0 1.5h-6.25V17a.75.75 0 0 1-1.5 0v-6.25H3a.75.75 0 0 1 0-1.5h6.25V3c0-.41.34-.75.75-.75Z"]),Sr=ze("CutRegular","1em",["M5.92 2.23a.5.5 0 0 0-.84.54L9.4 9.43l-1.92 2.96a3 3 0 1 0 .78.64L10 10.35l1.74 2.68a3 3 0 1 0 .78-.64L5.92 2.23ZM14 17a2 2 0 1 1 0-4 2 2 0 0 1 0 4ZM4 15a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm7.2-6.49-.6-.92 3.48-5.36a.5.5 0 0 1 .84.54l-3.73 5.74Z"]),Ar=ze("DeleteRegular","1em",["M8.5 4h3a1.5 1.5 0 0 0-3 0Zm-1 0a2.5 2.5 0 0 1 5 0h5a.5.5 0 0 1 0 1h-1.05l-1.2 10.34A3 3 0 0 1 12.27 18H7.73a3 3 0 0 1-2.98-2.66L3.55 5H2.5a.5.5 0 0 1 0-1h5ZM5.74 15.23A2 2 0 0 0 7.73 17h4.54a2 2 0 0 0 1.99-1.77L15.44 5H4.56l1.18 10.23ZM8.5 7.5c.28 0 .5.22.5.5v6a.5.5 0 0 1-1 0V8c0-.28.22-.5.5-.5ZM12 8a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V8Z"]),jr=ze("SplitVerticalRegular","1em",["M10 2.5a.5.5 0 0 0-1 0v15a.5.5 0 0 0 1 0v-15ZM4 4a2 2 0 0 0-2 2v8c0 1.1.9 2 2 2h4v-1H4a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h4V4H4Zm7 0v1h4a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1h-4v1h4a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-4Z"]),Er=ze("TextAlignRightFilled","1em",["M6 4.25c0-.41.34-.75.75-.75h10.5a.75.75 0 0 1 0 1.5H6.75A.75.75 0 0 1 6 4.25Zm-4 5c0-.41.34-.75.75-.75h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 9.25Zm7.75 4.25a.75.75 0 0 0 0 1.5h7.5a.75.75 0 0 0 0-1.5h-7.5Z"]),_r=ze("VideoBackgroundEffectFilled","1em",["M6.2 4 2 8.2V6.8L4.8 4h1.4Zm7 0-1.46 1.46a3.48 3.48 0 0 0-1.02-.39L11.79 4h1.42Zm-1.08 3.17a2.51 2.51 0 0 0-2.34-1.16 2.5 2.5 0 1 0 2.34 1.16Zm.72-.72c.2.29.37.6.48.94L16.69 4 16.5 4h-1.2l-2.46 2.45ZM7.5 12c-.08 0-.15 0-.22.02A1.5 1.5 0 0 0 6 13.5V16h8v-2.5a1.5 1.5 0 0 0-1.5-1.5h-5Zm5-1c.22 0 .43.03.63.08L18 6.2V5.5c0-.2-.04-.4-.12-.59l-4.5 4.5a3.5 3.5 0 0 1-.93 1.59h.05Zm1.9.88c.23.27.4.58.5.93L18 9.7V8.29l-3.6 3.6ZM15 16v-1.2l3-3v1.4L15.2 16H15Zm-10-.3v-1.4l-1.7 1.69.2.01h1.2l.3-.3Zm1.57-6.48c.08.36.21.7.4 1.02L2.11 15.1A1.5 1.5 0 0 1 2 14.5v-.7l4.57-4.58ZM9.71 4 2 11.7v-1.4L8.3 4h1.4Z"]),ve=t=>t,jt=t=>({_tag:"Left",value:t}),ut=t=>({_tag:"Right",value:t}),Wr=(t,e,r)=>r._tag==="Left"?t(r.value):e(r.value),tr={dimap:(t,e,r)=>n=>e(r(t(n))),first:t=>([e,r])=>[t(e),r],right:t=>e=>e._tag==="Left"?e:ut(t(e.value)),wander:t=>e=>e.map(t)},Cr={empty:()=>{},foldMap:(t,e)=>{for(let r=0;r<e.length;r++){const n=t(e[r]);if(n!=null)return n}}},Ir={empty:()=>[],foldMap:(t,e)=>{let r=[];return e.forEach(n=>{r=r.concat(t(n))}),r}},Et=t=>({dimap:(e,r,n)=>o=>n(e(o)),first:e=>([r,n])=>e(r),right:e=>r=>r._tag==="Left"?t.empty():e(r.value),wander:e=>r=>t.foldMap(e,r)}),vt={Equivalence:{Equivalence:"Equivalence",Iso:"Iso",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Iso:{Equivalence:"Iso",Iso:"Iso",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Lens:{Equivalence:"Lens",Iso:"Lens",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Prism:{Equivalence:"Prism",Iso:"Prism",Lens:"Prism",Prism:"Prism",Traversal:"Traversal",Getter:"AffineFold",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Traversal:{Equivalence:"Traversal",Iso:"Traversal",Lens:"Traversal",Prism:"Traversal",Traversal:"Traversal",Getter:"Fold",AffineFold:"Fold",Fold:"Fold",Setter:"Setter"},Getter:{Equivalence:"Getter",Iso:"Getter",Lens:"Getter",Prism:"AffineFold",Traversal:"Fold",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:void 0},AffineFold:{Equivalence:"AffineFold",Iso:"AffineFold",Lens:"AffineFold",Prism:"AffineFold",Traversal:"Fold",Getter:"AffineFold",AffineFold:"AffineFold",Fold:"Fold",Setter:void 0},Fold:{Equivalence:"Fold",Iso:"Fold",Lens:"Fold",Prism:"Fold",Traversal:"Fold",Getter:"Fold",AffineFold:"Fold",Fold:"Fold",Setter:void 0},Setter:{Equivalence:void 0,Iso:void 0,Lens:void 0,Prism:void 0,Traversal:void 0,Getter:void 0,AffineFold:void 0,Fold:void 0,Setter:void 0}},Pe=(t,e)=>{const r=e;return r._tag=t,r},rr=t=>(t._removable=!0,t);function V(t,e,r){switch(arguments.length){case 2:{const n=(o,c)=>t(o,e(o,c));return n._tag=vt[t._tag][e._tag],n._removable=e._removable||!1,n}default:{const n=vt[t._tag][e._tag],o=(c,u)=>t(c,e(c,r(c,u)));return o._tag=vt[n][r._tag],o._removable=r._removable||!1,o}}}const Rr=Pe("Equivalence",(t,e)=>e),mt=(t,e)=>Pe("Iso",(r,n)=>r.dimap(t,e,n)),me=(t,e)=>Pe("Lens",(r,n)=>r.dimap(o=>[t(o),o],e,r.first(n))),_t=(t,e)=>Pe("Prism",(r,n)=>r.dimap(t,o=>Wr(ve,e,o),r.right(n))),Wt=Pe("Traversal",(t,e)=>t.dimap(ve,ve,t.wander(e))),Fr=t=>Pe("Getter",(e,r)=>e.dimap(t,ve,r)),nr=(t,e,r)=>t(tr,e)(r),Mr=(t,e,r)=>t(tr,()=>e)(r),Nr=(t,e)=>t(Et({}),ve)(e),Dr=(t,e)=>t(Et(Cr),ve)(e),or=(t,e)=>t(Et(Ir),r=>[r])(e),Vr=mt(t=>t.map((e,r)=>[r,e]),t=>{const e=[...t].sort((n,o)=>n[0]-o[0]),r=[];for(let n=0;n<e.length;++n)(n===e.length-1||e[n][0]!==e[n+1][0])&&r.push(e[n][1]);return r}),Gt=t=>me(e=>e[t],([e,r])=>Object.assign(Object.assign({},r),{[t]:e})),kr=t=>me(e=>{const r={};for(const n of t)r[n]=e[n];return r},([e,r])=>{const n=Object.assign({},r);for(const o of t)delete n[o];return Object.assign(n,e)}),sr=t=>me(e=>e[t],([e,r])=>{const n=r.slice();return n[t]=e,n}),Ct=sr(0),It=t=>_t(e=>t(e)?ut(e):jt(e),ve),Ue=Symbol("__no_match__"),ir=It(t=>t!==Ue),cr=Symbol("__remove_me__"),St=t=>rr(V(me(e=>0<=t&&t<e.length?e[t]:Ue,([e,r])=>{if(e===Ue)return r;if(e===cr)return typeof r=="string"?r.substring(0,t)+r.substring(t+1):[...r.slice(0,t),...r.slice(t+1)];if(typeof r=="string")return t===0?e+r.substring(1):t===r.length?r.substring(0,t-1)+e:r.substring(0,t)+e+r.substring(t+1);{const n=r.slice();return n[t]=e,n}}),ir)),zr=_t(t=>t===void 0?jt(void 0):ut(t),ve),Pr=t=>_t(e=>t(e)?ut(e):jt(e),ve),Hr=t=>rr(V(me(e=>{const r=e.findIndex(t);return r===-1?[Ue,-1]:[e[r],r]},([[e,r],n])=>{if(e===Ue)return n;if(e===cr)return[...n.slice(0,r),...n.slice(r+1)];const o=n.slice();return o[r]=e,o}),Ct,ir)),Br=t=>V(me(e=>{const r=e.map((n,o)=>t(n)?o:null).filter(n=>n!=null);return[r.map(n=>e[n]),r]},([[e,r],n])=>{const o=n.length,c=e.length;let u=0,h=0,f=0;const a=[];for(;u<o;)r[h]===u?(++h,f<c&&(a.push(e[f]),++f)):a.push(n[u]),++u;for(;f<c;)a.push(e[f++]);return a}),Ct),Zr=t=>me(e=>e===void 0?t:e,([e,r])=>e),$r=t=>V(me(e=>{const r=or(t,e);return[r,r.length]},([[e,r],n])=>{if(e.length!==r)throw new Error("cannot add/remove elements through partsOf");let o=0;return nr(t,()=>e[o++],n)}),Ct),Gr=t=>me(e=>t(e),([e,r])=>e),Or=t=>me(e=>e,([e,r])=>t(e)),qr=me(t=>{},([t,e])=>t===void 0?e:[t,...e]),Yr=me(t=>{},([t,e])=>t===void 0?e:[...e,t]),Xr=V(mt(t=>t.split(""),t=>t.join("")),Wt),Kr=V(mt(t=>t.split(/\b/),t=>t.join("")),Wt,It(t=>!/\s+/.test(t)));class ${constructor(e){this._ref=e}get _tag(){return this._ref._tag}get _removable(){return this._ref._removable}compose(e){return new $(V(this._ref,e._ref))}iso(e,r){return new $(V(this._ref,mt(e,r)))}lens(e,r){return new $(V(this._ref,me(e,([n,o])=>r(o,n))))}indexed(){return new $(V(this._ref,Vr))}prop(e){return new $(V(this._ref,Gt(e)))}path(...e){return e.length===1&&(e=e[0].split(".")),new $(e.reduce((r,n)=>V(r,Gt(n)),this._ref))}pick(e){return new $(V(this._ref,kr(e)))}nth(e){return new $(V(this._ref,sr(e)))}filter(e){return new $(V(this._ref,Br(e)))}valueOr(e){return new $(V(this._ref,Zr(e)))}partsOf(e){const r=typeof e=="function"?e(lr):e;return new $(V(this._ref,$r(r._ref)))}reread(e){return new $(V(this._ref,Gr(e)))}rewrite(e){return new $(V(this._ref,Or(e)))}optional(){return new $(V(this._ref,zr))}guard_(){return e=>this.guard(e)}guard(e){return new $(V(this._ref,Pr(e)))}at(e){return new $(V(this._ref,St(e)))}head(){return new $(V(this._ref,St(0)))}index(e){return new $(V(this._ref,St(e)))}find(e){return new $(V(this._ref,Hr(e)))}elems(){return new $(V(this._ref,Wt))}to(e){return new $(V(this._ref,Fr(e)))}when(e){return new $(V(this._ref,It(e)))}chars(){return new $(V(this._ref,Xr))}words(){return new $(V(this._ref,Kr))}prependTo(){return new $(V(this._ref,qr))}appendTo(){return new $(V(this._ref,Yr))}}const lr=new $(Rr);function Ur(){return lr}function Jr(t){return e=>Nr(t._ref,e)}function Qr(t){return e=>Dr(t._ref,e)}function en(t){return e=>or(t._ref,e)}function tn(t){return e=>r=>nr(t._ref,e,r)}function rn(t){return e=>r=>Mr(t._ref,e,r)}const Ot=(t,e,r)=>(e.has(r)?e:e.set(r,t())).get(r),nn=new WeakMap,on=(t,e,r)=>{const n=Ot(()=>new WeakMap,nn,e);return Ot(t,n,r)},sn=t=>typeof t=="function";function cn(t,e){return on(()=>{const r=e(Ur());return oe(o=>{const c=o(t);return c instanceof Promise?c.then(u=>qt(r,u)):qt(r,c)},(o,c,u)=>{const h=sn(u)?tn(r)(u):rn(r)(u),f=o(t);return c(t,f instanceof Promise?f.then(h):h(f))})},t,e)}const qt=(t,e)=>t._tag==="Traversal"?en(t)(e):t._tag==="Prism"?Qr(t)(e):Jr(t)(e);var qe={},Yt;function ln(){if(Yt)return qe;Yt=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.ViewportList=void 0;const t=yr(),e=wr(),r=typeof window>"u",n=!r&&(()=>{try{return"ontouchstart"in window||navigator.maxTouchPoints}catch{return!1}})(),o=!r&&(()=>{try{return window.CSS.supports("overflow-anchor: auto")}catch{return!1}})(),c=n&&!o,u={top:"top",bottom:"bottom",clientHeight:"clientHeight",scrollHeight:"scrollHeight",scrollTop:"scrollTop",overflowY:"overflowY",height:"height",minHeight:"minHeight",maxHeight:"maxHeight",marginTop:"marginTop"},h={top:"left",bottom:"right",scrollHeight:"scrollWidth",clientHeight:"clientWidth",scrollTop:"scrollLeft",overflowY:"overflowX",minHeight:"minWidth",height:"width",maxHeight:"maxWidth",marginTop:"marginLeft"},f=(p,i,d=1/0)=>Math.max(Math.min(i,d),p),a=(p,i,d)=>Math.ceil(Math.abs(p-i)/d),g=r?e.useEffect:e.useLayoutEffect,S=(p,i,d)=>{const L=[];for(let T=p;T<i;T++)L.push(d(T));return L},m=({fromElement:p,toElement:i,fromIndex:d,asc:L=!0,compare:T})=>{let W=d,y=p;for(;y&&y!==i;){if(T(y,W))return[y,W];L?(W++,y=y.nextSibling):(W--,y=y.previousSibling)}return[null,-1]},I=/auto|scroll/gi,M=(p,i)=>{if(!i||i===document.body||i===document.documentElement)return document.documentElement;const d=window.getComputedStyle(i);return I.test(d[p.overflowY])||I.test(d.overflow)?i:M(p,i.parentNode)},N=(p,i,d=0)=>({padding:0,margin:0,border:"none",visibility:"hidden",overflowAnchor:"none",[p.minHeight]:i,[p.height]:i,[p.maxHeight]:i,[p.marginTop]:d}),b=({items:p=[],count:i,children:d,viewportRef:L,itemSize:T=0,itemMargin:W=-1,overscan:y=1,axis:v="y",initialIndex:R=-1,initialAlignToTop:j=!0,initialOffset:E=0,initialDelay:F=-1,initialPrerender:G=0,onViewportIndexesChange:X,overflowAnchor:_="auto",withCache:w=!0,scrollThreshold:H=0,renderSpacer:k=({ref:s,style:z})=>(0,t.jsx)("div",{ref:s,style:z}),indexesShift:Y=0,getItemBoundingClientRect:D=s=>s.getBoundingClientRect()},Q)=>{const s=v==="y"?u:h,z=typeof i=="number",C=(z?i:p.length)-1,[[q,ee],Ce]=(0,e.useState)(()=>[f(0,T),f(-1,W)]),he=f(0,q+ee),Qe=f(0,Math.ceil(y*he)),[ie,et]=(0,e.useState)([R-G,R+G]),je=(0,e.useRef)(null),Ie=(0,e.useRef)(-1),Ee=(0,e.useRef)(null),tt=(0,e.useRef)(null),pt=(0,e.useRef)(!1),Vt=(0,e.useRef)(Y),He=(0,e.useRef)([]),Se=(0,e.useRef)(R>=0?{index:R,alignToTop:j,offset:E,delay:F,prerender:G}:null),Be=(0,e.useRef)(null),Le=(0,e.useRef)(0),rt=(0,e.useRef)([-1,-1]),Ze=(0,e.useRef)(null),[K,ce]=(0,e.useMemo)(()=>{ie[0]=f(0,ie[0],C),ie[1]=f(ie[0],ie[1],C);const x=Y-Vt.current;Vt.current=Y;const B=Ee.current;return B&&x&&(ie[0]=f(0,ie[0]+x,C),ie[1]=f(ie[0],ie[1]+x,C),je.current=B.nextSibling,Ie.current=ie[0],pt.current=!0),ie},[Y,ie,C]),fr=(0,e.useMemo)(()=>N(s,(w?He.current:[]).slice(0,K).reduce((x,B)=>x+(B-q),K*he),Le.current),[s,w,K,he,q]),ur=(0,e.useMemo)(()=>N(s,(w?He.current:[]).slice(ce+1,C+1).reduce((x,B)=>x+(B-q),he*(C-ce))),[s,w,ce,C,he,q]),Re=(0,e.useMemo)(()=>{let x=null;return()=>{if(L)return L.current===document.body?document.documentElement:L.current;if(x&&x.isConnected)return x;const B=Ee.current;return B?(x=M(s,B.parentNode),x):null}},[s,L]),yt=(0,e.useRef)(()=>{}),kt=(0,e.useRef)(()=>({index:-1,offset:0}));g(()=>{yt.current=()=>{const x=Re(),B=Ee.current,U=tt.current;if(!x||!B||!U)return;const te=B.nextSibling,de=U.previousSibling,we=x.getBoundingClientRect(),se=B.getBoundingClientRect(),ne=U.getBoundingClientRect(),ue={[s.top]:x===document.documentElement?0:we[s.top],[s.bottom]:x===document.documentElement?document.documentElement[s.clientHeight]:we[s.bottom]},J={[s.top]:ue[s.top]-Qe,[s.bottom]:ue[s.bottom]+Qe};if(Le.current<0&&se[s.top]-Le.current>=J[s.top]||Le.current>0&&se[s.top]>=J[s.top]||Le.current&&Se.current){B.style[s.marginTop]="0px",x.style[s.overflowY]="hidden",x[s.scrollTop]+=-Le.current,x.style[s.overflowY]="",Le.current=0;return}if(q===0||ee===-1){let O=0;if(m({fromElement:te,toElement:U,fromIndex:K,compare:We=>(O+=D(We)[s.height],!1)}),!O)return;const le=ce-K+1,xe=q===0?Math.ceil(O/le):q,_e=ee===-1?Math.ceil((ne[s.top]-se[s.bottom]-O)/le):ee;Ce([xe,_e]);return}if(Be.current)return;if(Se.current){const O=f(0,Se.current.index,C);if(O<K||O>ce){et([O-Se.current.prerender,O+Se.current.prerender]);return}const[le]=m({fromElement:te,toElement:U,fromIndex:K,compare:(bt,Lt)=>Lt===O});if(!le)return;const{alignToTop:xe,offset:_e,delay:We}=Se.current;Se.current=null;const Pt=()=>{const bt=D(le),Lt=xe?bt[s.top]-ue[s.top]+_e:bt[s.bottom]-ue[s.top]-x[s.clientHeight]+_e;x[s.scrollTop]+=Lt,Be.current=null},Ht=We<0&&c?30:We;if(Ht>0){Be.current=setTimeout(Pt,Ht);return}Pt();return}if(Ze.current===null)Ze.current=x.scrollTop;else if(Ze.current!==x.scrollTop){const O=Math.abs(x.scrollTop-Ze.current);if(Ze.current=x.scrollTop,H>0&&O>H)return}const $e=te===U?U:te.nextSibling,zt=de===B?B:de.previousSibling,Fe=Math.ceil((ne[s.top]-se[s.bottom])/(ce+1-K)),Ge=se[s.bottom]>J[s.bottom],Oe=ne[s.top]<J[s.top],mr=!Ge&&!Oe&&se[s.bottom]>J[s.top],hr=!Ge&&!Oe&&ne[s.top]<J[s.bottom],gr=!Ge&&!Oe&&(zt===B?se:D(zt))[s.bottom]>J[s.bottom],pr=!Ge&&!Oe&&($e===U?ne:D($e))[s.top]<J[s.top];let ge=K,Ae=ce;if(Ge&&(ge-=a(se[s.bottom],J[s.top],Fe),Ae-=a(ne[s.top],J[s.bottom],Fe)),Oe&&(Ae+=a(ne[s.top],J[s.bottom],Fe),ge+=a(se[s.bottom],J[s.top],Fe)),mr&&(ge-=a(se[s.bottom],J[s.top],Fe)),hr&&(Ae+=a(ne[s.top],J[s.bottom],Fe)),gr){const[,O]=m({fromElement:de,toElement:B,fromIndex:ce,asc:!1,compare:le=>D(le)[s.bottom]<=J[s.bottom]});O!==-1&&(Ae=O+1)}if(pr){const[,O]=m({fromElement:te,toElement:U,fromIndex:K,compare:le=>D(le)[s.top]>=J[s.top]});O!==-1&&(ge=O-1)}if(X){let[,O]=m({fromElement:te,toElement:U,fromIndex:K,compare:xe=>D(xe)[s.bottom]>ue[s.top]});O===-1&&(O=K);let[,le]=m({fromElement:de,toElement:B,fromIndex:ce,asc:!1,compare:xe=>D(xe)[s.top]<ue[s.bottom]});le===-1&&(le=ce),(O!==rt.current[0]||le!==rt.current[1])&&(rt.current=[O,le],X(rt.current))}if(ge=f(0,ge,C),Ae=f(ge,Ae,C),!(ge===K&&Ae===ce)){if(ge!==K)if(K>=ge)je.current=te,Ie.current=K;else{const[O,le]=m({fromElement:te,toElement:U,fromIndex:K,compare:(xe,_e)=>{if(_e===ge)return!0;const We=D(xe);return We[s.height]!==q&&(He.current[_e]=We[s.height]),!1}});O?(je.current=O,Ie.current=le):(je.current=de,Ie.current=ce)}et([ge,Ae])}},kt.current=()=>{const x=Re(),B=Ee.current,U=tt.current;let te=-1,de=0;if(!x||!B||!U)return{index:te,offset:de};const we=B.nextSibling,se=x.getBoundingClientRect(),ne={[s.top]:x===document.documentElement?0:se[s.top],[s.bottom]:x===document.documentElement?document.documentElement[s.clientHeight]:se[s.bottom]};return m({fromElement:we,toElement:U,fromIndex:K,compare:(ue,J)=>{const $e=D(ue);return te=J,de=ne[s.top]-$e[s.top],$e[s.bottom]>ne[s.top]}}),{index:te,offset:de}}});let wt;return je.current&&Re()&&Ee.current&&(wt=D(je.current)[s.top]-(Re()===document.documentElement?0:Re().getBoundingClientRect()[s.top])),g(()=>{je.current=null;const x=Ie.current,B=pt.current;Ie.current=-1,pt.current=!1;const U=Re(),te=Ee.current,de=tt.current;if(x===-1||!U||!te||!de||wt===void 0||o&&_!=="none"&&!B)return;let we=null;if(x>=K&&x<=ce){const[ne]=m({fromElement:te.nextSibling,toElement:de,fromIndex:K,compare:(ue,J)=>J===x});ne&&(we=D(ne)[s.top])}else x<K?we=te.getBoundingClientRect()[s.top]+(w?He.current:[]).slice(0,x).reduce((ne,ue)=>ne+(ue-q),x*he):x<=C&&(we=de.getBoundingClientRect()[s.top]+(w?He.current:[]).slice(ce+1,x).reduce((ne,ue)=>ne+(ue-q),he*(x-1-ce)));if(we===null)return;const se=we-(U===document.documentElement?0:U.getBoundingClientRect()[s.top])-wt;if(se){if(n){Le.current-=se,te.style[s.marginTop]=`${Le.current}px`;return}U[s.scrollTop]+=se}},[K]),g(()=>{let x;const B=()=>{x=requestAnimationFrame(B),yt.current()};return B(),()=>{cancelAnimationFrame(x),Be.current&&clearTimeout(Be.current)}},[]),(0,e.useImperativeHandle)(Q,()=>({scrollToIndex:({index:x=-1,alignToTop:B=!0,offset:U=0,delay:te=-1,prerender:de=0})=>{Se.current={index:x,alignToTop:B,offset:U,delay:te,prerender:de},yt.current()},getScrollPosition:()=>kt.current()}),[]),(0,t.jsxs)(e.Fragment,{children:[k({ref:Ee,style:fr,type:"top"}),(!!i||!!p.length)&&S(K,ce+1,z?d:x=>d(p[x],x,p)),k({ref:tt,style:ur,type:"bottom"})]})};return qe.ViewportList=(0,e.forwardRef)(b),qe}var an=ln();globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Ne=globalThis.jotaiAtomCache.get("D:\\github project\\新建文件夹\\amll-ttml-tool\\src\\components\\LyricLinesView\\lyric-line-view-states.ts/draggingIdAtom",oe(""));Ne.debugLabel="draggingIdAtom";Ne.debugLabel="draggingIdAtom";const dn="_lyricWord_2dcap_11",fn="_edit_2dcap_12",un="_sync_2dcap_19",mn="_dropLeft_2dcap_26",hn="_dropRight_2dcap_29",gn="_advance_2dcap_32",pn="_advanceBar_2dcap_40",yn="_displayWord_2dcap_47",wn="_startTime_2dcap_50",bn="_endTime_2dcap_51",Ln="_lyricLine_2dcap_76",xn="_dropTop_2dcap_81",Tn="_dropBottom_2dcap_84",vn="_ignoreSync_2dcap_87",Sn="_insertWordField_2dcap_96",An="_empty_2dcap_107",jn="_lyricLineContainer_2dcap_111",En="_lyricWordsContainer_2dcap_121",_n="_blank_2dcap_143",Wn="_selected_2dcap_151",Cn="_active_2dcap_172",A={lyricWord:dn,edit:fn,sync:un,dropLeft:mn,dropRight:hn,advance:gn,advanceBar:pn,displayWord:yn,startTime:wn,endTime:bn,lyricLine:Ln,dropTop:xn,dropBottom:Tn,ignoreSync:vn,insertWordField:Sn,empty:An,lyricLineContainer:jn,lyricWordsContainer:En,blank:_n,selected:Wn,active:Cn};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Rt=globalThis.jotaiAtomCache.get("D:\\github project\\新建文件夹\\amll-ttml-tool\\src\\components\\LyricLinesView\\lyric-line-menu.tsx/selectedLinesSizeAtom",oe(t=>t(pe).size));Rt.debugLabel="selectedLinesSizeAtom";Rt.debugLabel="selectedLinesSizeAtom";const ht=t=>{const e=ye.c(5),{lineIndex:r}=t,n=P(Rt),o=P(pe),c=ae(be);let u;return e[0]!==c||e[1]!==r||e[2]!==o||e[3]!==n?(u=l.jsx(l.Fragment,{children:l.jsx(ot,{onClick:()=>{c(h=>{n===0?h.lyricLines.splice(r,1):h.lyricLines=h.lyricLines.filter(f=>!o.has(f.id))})},children:"删除所选歌词行"})}),e[0]=c,e[1]=r,e[2]=o,e[3]=n,e[4]=u):u=e[4],u};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Ft=globalThis.jotaiAtomCache.get("D:\\github project\\新建文件夹\\amll-ttml-tool\\src\\components\\LyricLinesView\\lyric-word-menu.tsx/selectedLinesSizeAtom",oe(t=>t(pe).size));Ft.debugLabel="selectedLinesSizeAtom";Ft.debugLabel="selectedLinesSizeAtom";const Mt=globalThis.jotaiAtomCache.get("D:\\github project\\新建文件夹\\amll-ttml-tool\\src\\components\\LyricLinesView\\lyric-word-menu.tsx/selectedWordsSizeAtom",oe(t=>t(fe).size));Mt.debugLabel="selectedWordsSizeAtom";Mt.debugLabel="selectedWordsSizeAtom";const Nt=t=>{const e=ye.c(27),{wordIndex:r,wordAtom:n,lineIndex:o}=t,c=Je(),u=P(Mt),h=P(Ft),f=ae(be),a=it(Kt),g=it(Ut),S=P(n),m=u===0;let I;e[0]!==f||e[1]!==c?(I=()=>{f(W=>{const y=c.get(fe);for(const v of W.lyricLines)v.words=v.words.filter(R=>!y.has(R.id))})},e[0]=f,e[1]=c,e[2]=I):I=e[2];let M;e[3]!==m||e[4]!==I?(M=l.jsx(ot,{disabled:m,onClick:I,children:"删除所选单词"}),e[3]=m,e[4]=I,e[5]=M):M=e[5];const N=u!==1;let b;e[6]!==o||e[7]!==a||e[8]!==g||e[9]!==S.word||e[10]!==r?(b=()=>{g({wordIndex:r,lineIndex:o,word:S.word}),a(!0)},e[6]=o,e[7]=a,e[8]=g,e[9]=S.word,e[10]=r,e[11]=b):b=e[11];let p;e[12]!==N||e[13]!==b?(p=l.jsx(ot,{disabled:N,onClick:b,children:"拆分此单词/在此处替换单词"}),e[12]=N,e[13]=b,e[14]=p):p=e[14];const i=!(u>1&&h===1);let d;e[15]!==f||e[16]!==o||e[17]!==c||e[18]!==r?(d=()=>{f(W=>{const y=c.get(fe),v=W.lyricLines[o];if(v){let R=-1,j="";for(const F of v.words)y.has(F.id)&&(j=j+F.word,R===-1&&(R=v.words.indexOf(F)));const E=st();E.word=j,E.startTime=v.words[r].startTime,W.lyricLines[o].words=v.words.filter(F=>!y.has(F.id)),R!==-1&&W.lyricLines[o].words.splice(R,0,E)}})},e[15]=f,e[16]=o,e[17]=c,e[18]=r,e[19]=d):d=e[19];let L;e[20]!==i||e[21]!==d?(L=l.jsx(ot,{disabled:i,onClick:d,children:"合并单词"}),e[20]=i,e[21]=d,e[22]=L):L=e[22];let T;return e[23]!==M||e[24]!==p||e[25]!==L?(T=l.jsxs(l.Fragment,{children:[M,p,L]}),e[23]=M,e[24]=p,e[25]=L,e[26]=T):T=e[26],T};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const De=globalThis.jotaiAtomCache.get("D:\\github project\\新建文件夹\\amll-ttml-tool\\src\\components\\LyricLinesView\\lyric-word-view.tsx/isDraggingAtom",oe(!1));De.debugLabel="isDraggingAtom";De.debugLabel="isDraggingAtom";const Xe=globalThis.jotaiAtomCache.get("D:\\github project\\新建文件夹\\amll-ttml-tool\\src\\components\\LyricLinesView\\lyric-word-view.tsx/draggingIdAtom",oe(""));Xe.debugLabel="draggingIdAtom";Xe.debugLabel="draggingIdAtom";const gt=t=>{let e;return e=t.length===0||t.length>0&&t.trim().length===0,e},ar=t=>{const e=ye.c(52),{wordAtom:r,wordIndex:n,line:o,lineIndex:c,className:u,children:h,onDoubleClick:f}=t,a=P(r),g=Je(),S=ae(be),m=ae(pe);let I,M;e[0]!==r?(M=oe(_=>_(fe).has(_(r).id)),e[0]=r,e[1]=M):M=e[1],I=M;const b=P(I),p=ae(fe),i=P(ct);let d;e[2]!==b||e[3]!==o||e[4]!==m||e[5]!==p||e[6]!==a.id?(d=_=>{_&&(b||(p(w=>{w.clear(),w.add(a.id)}),m(w=>{w.clear(),w.add(o.id)})))},e[2]=b,e[3]=o,e[4]=m,e[5]=p,e[6]=a.id,e[7]=d):d=e[7];const L=i===re.Edit;let T;e[8]!==g||e[9]!==a.id?(T=_=>{_.dataTransfer.dropEffect="move",g.set(De,!0),g.set(Xe,a.id),_.stopPropagation()},e[8]=g,e[9]=a.id,e[10]=T):T=e[10];let W;e[11]!==g?(W=()=>{g.set(De,!1)},e[11]=g,e[12]=W):W=e[12];let y;e[13]!==b||e[14]!==g||e[15]!==a.id?(y=_=>{if(!g.get(De)||g.get(Xe)===a.id||b)return;_.preventDefault(),_.dataTransfer.dropEffect="move";const w=_.currentTarget.getBoundingClientRect();_.clientX-w.left<w.width/2?(_.currentTarget.classList.add(A.dropLeft),_.currentTarget.classList.remove(A.dropRight)):(_.currentTarget.classList.remove(A.dropLeft),_.currentTarget.classList.add(A.dropRight))},e[13]=b,e[14]=g,e[15]=a.id,e[16]=y):y=e[16];let v;e[17]!==S||e[18]!==b||e[19]!==o||e[20]!==g||e[21]!==a.id?(v=_=>{if(_.currentTarget.classList.remove(A.dropLeft),_.currentTarget.classList.remove(A.dropRight),!g.get(De))return;const w=_.currentTarget.getBoundingClientRect(),H=_.clientX-w.left,k=new Set(g.get(fe)),Y=g.get(Xe);b||(k.clear(),k.add(Y)),H<w.width/2?S(D=>{const Q=[];for(const C of D.lyricLines){const q=C.words.filter(ee=>k.has(ee.id));Q.push(...q),C.words=C.words.filter(ee=>!k.has(ee.id))}const s=D.lyricLines.find(C=>C.id===o.id);if(!s)return;const z=s.words.findIndex(C=>C.id===a.id);z<0||s.words.splice(z,0,...Q)}):S(D=>{const Q=[];for(const C of D.lyricLines){const q=C.words.filter(ee=>k.has(ee.id));Q.push(...q),C.words=C.words.filter(ee=>!k.has(ee.id))}const s=D.lyricLines.find(C=>C.id===o.id);if(!s)return;const z=s.words.findIndex(C=>C.id===a.id);z<0||s.words.splice(z+1,0,...Q)})},e[17]=S,e[18]=b,e[19]=o,e[20]=g,e[21]=a.id,e[22]=v):v=e[22];let R;e[23]!==o||e[24]!==m||e[25]!==p||e[26]!==a.id||e[27]!==n?(R=_=>{_.stopPropagation(),_.preventDefault(),_.ctrlKey||_.metaKey?p(w=>{w.has(a.id)?w.delete(a.id):w.add(a.id)}):_.shiftKey?p(w=>{if(w.size>0){let H;H=Number.NaN;let k;k=Number.NaN,o.words.forEach((Y,D)=>{w.has(Y.id)&&(Number.isNaN(H)&&(H=D),Number.isNaN(k)&&(k=D),H=Math.min(H,D,n),k=Math.max(k,D,n))});for(let Y=H;Y<=k;Y++)w.add(o.words[Y].id)}else w.add(a.id)}):(m(w=>{(!w.has(o.id)||w.size!==1)&&(w.clear(),w.add(o.id))}),p(w=>{(!w.has(a.id)||w.size!==1)&&(w.clear(),w.add(a.id))}))},e[23]=o,e[24]=m,e[25]=p,e[26]=a.id,e[27]=n,e[28]=R):R=e[28];let j;e[29]!==h||e[30]!==u||e[31]!==f||e[32]!==L||e[33]!==T||e[34]!==W||e[35]!==y||e[36]!==v||e[37]!==R?(j=l.jsx(dt,{children:l.jsx("span",{draggable:L,onDragStart:T,onDragEnd:W,onDragOver:y,onDrop:v,onDragLeave:Nn,className:u,onDoubleClick:f,onClick:R,children:h})}),e[29]=h,e[30]=u,e[31]=f,e[32]=L,e[33]=T,e[34]=W,e[35]=y,e[36]=v,e[37]=R,e[38]=j):j=e[38];let E;e[39]!==c||e[40]!==r||e[41]!==n?(E=l.jsx(Nt,{wordAtom:r,wordIndex:n,lineIndex:c}),e[39]=c,e[40]=r,e[41]=n,e[42]=E):E=e[42];let F;e[43]!==c?(F=l.jsx(ht,{lineIndex:c}),e[43]=c,e[44]=F):F=e[44];let G;e[45]!==E||e[46]!==F?(G=l.jsxs(ft,{children:[E,F]}),e[45]=E,e[46]=F,e[47]=G):G=e[47];let X;return e[48]!==j||e[49]!==G||e[50]!==d?(X=l.jsxs(at,{onOpenChange:d,children:[j,G]}),e[48]=j,e[49]=G,e[50]=d,e[51]=X):X=e[51],X};function nt(t){const e=ye.c(35);let r,n,o,c,u,h;if(e[0]!==t){const{wordAtom:F,fieldName:G,formatter:X,parser:_,textFieldStyle:w,children:H,...k}=t;h=F,n=G,o=X,u=_,r=H,c=k,e[0]=t,e[1]=r,e[2]=n,e[3]=o,e[4]=c,e[5]=u,e[6]=h}else r=e[1],n=e[2],o=e[3],c=e[4],u=e[5],h=e[6];const[f,a]=Z.useState(void 0),[g,S]=Z.useState(""),m=ae(be);let I,M;e[7]!==n||e[8]!==o||e[9]!==h?(M=oe(F=>{const G=F(h);return o(G[n])}),e[7]=n,e[8]=o,e[9]=h,e[10]=M):M=e[10],I=M;const b=P(I),p=Je();let i;e[11]!==b||e[12]!==m||e[13]!==n||e[14]!==u||e[15]!==p||e[16]!==h?(i=F=>{try{const G=p.get(h),X=u(F);m(_=>{for(const w of _.lyricLines)for(const H of w.words)if(G.id===H.id){H[n]=X;break}return _})}catch{typeof b=="string"&&a(b)}},e[11]=b,e[12]=m,e[13]=n,e[14]=u,e[15]=p,e[16]=h,e[17]=i):i=e[17];const d=i;let L,T;e[18]!==b?(L=()=>{a(b),S("")},T=[b],e[18]=b,e[19]=L,e[20]=T):(L=e[19],T=e[20]),Z.useLayoutEffect(L,T);const W=f??"",y=f===void 0;let v;e[21]===Symbol.for("react.memo_cache_sentinel")?(v=F=>a(F.currentTarget.value),e[21]=v):v=e[21];let R;e[22]!==d?(R=F=>{F.key==="Enter"&&d(F.currentTarget.value)},e[22]=d,e[23]=R):R=e[23];let j;e[24]!==b||e[25]!==d?(j=F=>{F.currentTarget.value!==b&&d(F.currentTarget.value)},e[24]=b,e[25]=d,e[26]=j):j=e[26];let E;return e[27]!==r||e[28]!==g||e[29]!==c||e[30]!==j||e[31]!==W||e[32]!==y||e[33]!==R?(E=l.jsx(lt,{size:"1",value:W,placeholder:g,disabled:y,onChange:v,onKeyDown:R,onBlur:j,...c,children:r}),e[27]=r,e[28]=g,e[29]=c,e[30]=j,e[31]=W,e[32]=y,e[33]=R,e[34]=E):E=e[34],E}const In=t=>{const e=ye.c(61),{wordAtom:r,wordIndex:n,line:o,lineIndex:c}=t,u=Je(),h=ae(be),f=it(Kt),a=it(Ut),g=P(r);let S,m;e[0]!==r?(m=oe(he=>he(fe).has(he(r).id)),e[0]=r,e[1]=m):m=e[1],S=m;const M=P(S),N=gt(g.word);let b;const p=M&&A.selected,i=N&&A.blank;let d;e[2]!==p||e[3]!==i?(d=Te(A.lyricWord,A.edit,A.advance,p,i),e[2]=p,e[3]=i,e[4]=d):d=e[4],b=d;const L=b;let T;e[5]===Symbol.for("react.memo_cache_sentinel")?(T={minWidth:"0"},e[5]=T):T=e[5];let W;e[6]===Symbol.for("react.memo_cache_sentinel")?(W=l.jsx(xt,{children:l.jsx(xr,{})}),e[6]=W):W=e[6];let y;e[7]!==r?(y=l.jsx(nt,{size:"1",color:"green",wordAtom:r,fieldName:"startTime",formatter:ke,parser:Zt,style:T,children:W}),e[7]=r,e[8]=y):y=e[8];let v;e[9]!==c||e[10]!==f||e[11]!==a||e[12]!==g.word||e[13]!==n?(v=()=>{a({wordIndex:n,lineIndex:c,word:g.word}),f(!0)},e[9]=c,e[10]=f,e[11]=a,e[12]=g.word,e[13]=n,e[14]=v):v=e[14];let R;e[15]===Symbol.for("react.memo_cache_sentinel")?(R=l.jsx(Sr,{}),e[15]=R):R=e[15];let j;e[16]!==v?(j=l.jsx(Ye,{variant:"soft",size:"1",onClick:v,children:R}),e[16]=v,e[17]=j):j=e[17];let E;e[18]===Symbol.for("react.memo_cache_sentinel")?(E={minWidth:"0em"},e[18]=E):E=e[18];let F;e[19]!==r?(F=l.jsx(nt,{size:"1",wordAtom:r,fieldName:"word",formatter:String,parser:String,style:E}),e[19]=r,e[20]=F):F=e[20];let G;e[21]!==h||e[22]!==u?(G=()=>{h(he=>{const Qe=u.get(fe);for(const ie of he.lyricLines)ie.words=ie.words.filter(et=>!Qe.has(et.id))})},e[21]=h,e[22]=u,e[23]=G):G=e[23];let X;e[24]===Symbol.for("react.memo_cache_sentinel")?(X=l.jsx(Ar,{}),e[24]=X):X=e[24];let _;e[25]!==G?(_=l.jsx(Ye,{variant:"soft",size:"1",onClick:G,children:X}),e[25]=G,e[26]=_):_=e[26];let w;e[27]!==j||e[28]!==F||e[29]!==_?(w=l.jsxs("div",{className:A.advanceBar,children:[j,F,_]}),e[27]=j,e[28]=F,e[29]=_,e[30]=w):w=e[30];let H;e[31]===Symbol.for("react.memo_cache_sentinel")?(H={minWidth:"0"},e[31]=H):H=e[31];let k;e[32]===Symbol.for("react.memo_cache_sentinel")?(k=l.jsx(xt,{children:l.jsx(Tr,{})}),e[32]=k):k=e[32];let Y;e[33]!==r?(Y=l.jsx(nt,{size:"1",color:"red",wordAtom:r,fieldName:"endTime",formatter:ke,parser:Zt,style:H,children:k}),e[33]=r,e[34]=Y):Y=e[34];let D;e[35]===Symbol.for("react.memo_cache_sentinel")?(D={minWidth:"0"},e[35]=D):D=e[35];let Q;e[36]===Symbol.for("react.memo_cache_sentinel")?(Q=l.jsx(xt,{children:l.jsx(jr,{})}),e[36]=Q):Q=e[36];let s;e[37]!==r?(s=l.jsx(nt,{size:"1",type:"number",min:0,wordAtom:r,fieldName:"emptyBeat",formatter:String,parser:Number.parseInt,style:D,children:Q}),e[37]=r,e[38]=s):s=e[38];let z;e[39]!==L||e[40]!==o||e[41]!==c||e[42]!==w||e[43]!==Y||e[44]!==s||e[45]!==y||e[46]!==r||e[47]!==n?(z=l.jsx(dt,{children:l.jsxs(ar,{wordAtom:r,wordIndex:n,lineIndex:c,className:L,line:o,children:[y,w,Y,s]})}),e[39]=L,e[40]=o,e[41]=c,e[42]=w,e[43]=Y,e[44]=s,e[45]=y,e[46]=r,e[47]=n,e[48]=z):z=e[48];let C;e[49]!==c||e[50]!==r||e[51]!==n?(C=l.jsx(Nt,{wordAtom:r,wordIndex:n,lineIndex:c}),e[49]=c,e[50]=r,e[51]=n,e[52]=C):C=e[52];let q;e[53]!==c?(q=l.jsx(ht,{lineIndex:c}),e[53]=c,e[54]=q):q=e[54];let ee;e[55]!==C||e[56]!==q?(ee=l.jsxs(ft,{children:[C,q]}),e[55]=C,e[56]=q,e[57]=ee):ee=e[57];let Ce;return e[58]!==z||e[59]!==ee?(Ce=l.jsxs(at,{children:[z,ee]}),e[58]=z,e[59]=ee,e[60]=Ce):Ce=e[60],Ce},Rn=t=>{const e=ye.c(24),{wordAtom:r,wordIndex:n,line:o,lineIndex:c}=t,u=P(r),h=ae(be),f=ae(pe);let a,g;e[0]!==r?(g=oe(j=>j(fe).has(j(r).id)),e[0]=r,e[1]=g):g=e[1],a=g;const m=P(a),I=ae(fe),[M,N]=Z.useState(!1),b=gt(u.word),p=dr(u.word,b);let i;const d=m&&A.selected,L=b&&A.blank;let T;e[2]!==d||e[3]!==L?(T=Te(A.lyricWord,A.edit,d,L),e[2]=d,e[3]=L,e[4]=T):T=e[4],i=T;const W=i;let y;e[5]!==h||e[6]!==c||e[7]!==u.word||e[8]!==n?(y=j=>{N(!1);const E=j.currentTarget.value;E!==u.word&&h(F=>{F.lyricLines[c].words[n].word=E})},e[5]=h,e[6]=c,e[7]=u.word,e[8]=n,e[9]=y):y=e[9];const v=y;let R;return e[10]!==W||e[11]!==p||e[12]!==M||e[13]!==m||e[14]!==o||e[15]!==c||e[16]!==v||e[17]!==f||e[18]!==I||e[19]!==u.id||e[20]!==u.word||e[21]!==r||e[22]!==n?(R=M?l.jsx(lt,{autoFocus:!0,defaultValue:u.word,onBlur:v,onKeyDown:j=>{j.key==="Enter"&&v(j)}}):l.jsxs(at,{onOpenChange:j=>{j&&(m||(I(E=>{E.clear(),E.add(u.id)}),f(E=>{E.clear(),E.add(o.id)})))},children:[l.jsx(dt,{children:l.jsx(ar,{wordAtom:r,wordIndex:n,lineIndex:c,className:W,line:o,onDoubleClick:()=>{N(!0)},children:p})}),l.jsxs(ft,{children:[l.jsx(Nt,{wordAtom:r,wordIndex:n,lineIndex:c}),l.jsx(ht,{lineIndex:c})]})]}),e[10]=W,e[11]=p,e[12]=M,e[13]=m,e[14]=o,e[15]=c,e[16]=v,e[17]=f,e[18]=I,e[19]=u.id,e[20]=u.word,e[21]=r,e[22]=n,e[23]=R):R=e[23],R},Fn=t=>{const e=ye.c(41),{wordAtom:r,line:n}=t,o=P(r);let c,u;e[0]!==r?(u=oe(z=>z(fe).has(z(r).id)),e[0]=r,e[1]=u):u=e[1],c=u;const h=c;let f,a;e[2]!==r?(a=oe(z=>{const C=z(Lr),q=z(r);return C>=q.startTime&&C<q.endTime}),e[2]=r,e[3]=a):a=e[3],f=a;const S=P(f),m=P(h),I=ae(fe),M=ae(pe),N=P(Jt),b=gt(o.word),p=dr(o.word,b),i=Z.useRef(null),d=Z.useRef(null);let L;e[4]!==N?(L=()=>{if(!N)return;const z=i.current?.animate([{backgroundColor:"var(--green-a8)"},{backgroundColor:"var(--green-a4)"}],{duration:500});return()=>{z?.cancel()}},e[4]=N,e[5]=L):L=e[5];let T;e[6]!==N||e[7]!==o.startTime?(T=[o.startTime,N],e[6]=N,e[7]=o.startTime,e[8]=T):T=e[8],Z.useEffect(L,T);let W;e[9]!==N?(W=()=>{if(!N)return;const z=d.current?.animate([{backgroundColor:"var(--red-a8)"},{backgroundColor:"var(--red-a4)"}],{duration:500});return()=>{z?.cancel()}},e[9]=N,e[10]=W):W=e[10];let y;e[11]!==N||e[12]!==o.endTime?(y=[o.endTime,N],e[11]=N,e[12]=o.endTime,e[13]=y):y=e[13],Z.useEffect(W,y);let v;const R=m&&A.selected,j=b&&A.blank,E=S&&A.active;let F;e[14]!==R||e[15]!==j||e[16]!==E?(F=Te(A.lyricWord,A.sync,R,j,E),e[14]=R,e[15]=j,e[16]=E,e[17]=F):F=e[17],v=F;const G=v;let X;e[18]!==n.id||e[19]!==M||e[20]!==I||e[21]!==o.id?(X=z=>{z.stopPropagation(),z.preventDefault(),M(C=>{C.clear(),C.add(n.id)}),I(C=>{C.clear(),C.add(o.id)})},e[18]=n.id,e[19]=M,e[20]=I,e[21]=o.id,e[22]=X):X=e[22];let _;e[23]===Symbol.for("react.memo_cache_sentinel")?(_=Te(A.startTime),e[23]=_):_=e[23];let w;e[24]!==o.startTime?(w=ke(o.startTime),e[24]=o.startTime,e[25]=w):w=e[25];let H;e[26]!==w?(H=l.jsx("div",{className:_,ref:i,children:w}),e[26]=w,e[27]=H):H=e[27];let k;e[28]!==p?(k=l.jsx("div",{className:A.displayWord,children:p}),e[28]=p,e[29]=k):k=e[29];let Y;e[30]===Symbol.for("react.memo_cache_sentinel")?(Y=Te(A.endTime),e[30]=Y):Y=e[30];let D;e[31]!==o.endTime?(D=ke(o.endTime),e[31]=o.endTime,e[32]=D):D=e[32];let Q;e[33]!==D?(Q=l.jsx("div",{className:Y,ref:d,children:D}),e[33]=D,e[34]=Q):Q=e[34];let s;return e[35]!==G||e[36]!==X||e[37]!==H||e[38]!==k||e[39]!==Q?(s=l.jsxs("div",{className:G,onClick:X,children:[H,k,Q]}),e[35]=G,e[36]=X,e[37]=H,e[38]=k,e[39]=Q,e[40]=s):s=e[40],s},dr=(t,e)=>{const r=ye.c(5),{t:n}=Qt();let o;e:{if(t===""){let c;r[0]!==n?(c=n("lyricWordView.empty","空白"),r[0]=n,r[1]=c):c=r[1],o=c;break e}if(e){let c;r[2]!==n||r[3]!==t.length?(c=n("lyricWordView.spaceCount","空格 x{count}",{count:t.length}),r[2]=n,r[3]=t.length,r[4]=c):c=r[4],o=c;break e}o=t}return o},Mn=Z.memo(t=>{const e=ye.c(25),{wordAtom:r,wordIndex:n,line:o,lineIndex:c}=t,u=P(r),h=P(ct),f=P(br),a=gt(u.word);let g;e[0]!==f||e[1]!==o||e[2]!==c||e[3]!==h||e[4]!==r||e[5]!==n?(g=h===re.Edit&&f===Bt.Simple&&l.jsx(Rn,{wordAtom:r,line:o,lineIndex:c,wordIndex:n}),e[0]=f,e[1]=o,e[2]=c,e[3]=h,e[4]=r,e[5]=n,e[6]=g):g=e[6];let S;e[7]!==f||e[8]!==o||e[9]!==c||e[10]!==h||e[11]!==r||e[12]!==n?(S=h===re.Edit&&f===Bt.Advance&&l.jsx(In,{wordAtom:r,line:o,lineIndex:c,wordIndex:n}),e[7]=f,e[8]=o,e[9]=c,e[10]=h,e[11]=r,e[12]=n,e[13]=S):S=e[13];let m;e[14]!==a||e[15]!==o||e[16]!==c||e[17]!==h||e[18]!==r||e[19]!==n?(m=h===re.Sync&&!a&&l.jsx(Fn,{wordAtom:r,line:o,lineIndex:c,wordIndex:n}),e[14]=a,e[15]=o,e[16]=c,e[17]=h,e[18]=r,e[19]=n,e[20]=m):m=e[20];let I;return e[21]!==g||e[22]!==S||e[23]!==m?(I=l.jsxs("div",{children:[g,S,m]}),e[21]=g,e[22]=S,e[23]=m,e[24]=I):I=e[24],I});function Nn(t){t.currentTarget.classList.remove(A.dropLeft),t.currentTarget.classList.remove(A.dropRight)}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Ve=globalThis.jotaiAtomCache.get("D:\\github project\\新建文件夹\\amll-ttml-tool\\src\\components\\LyricLinesView\\lyric-line-view.tsx/isDraggingAtom",oe(!1));Ve.debugLabel="isDraggingAtom";Ve.debugLabel="isDraggingAtom";const Dn=t=>{const e=ye.c(6),{lineAtom:r,wordsContainer:n}=t;let o,c;e[0]!==r?(c=oe(g=>{const S=g(r),m=g(fe);if(m.size===0)return Number.NaN;let I=Number.NaN,M=0;for(const N of S.words){if(m.has(N.id)){I=M;break}M++}return I}),e[0]=r,e[1]=c):c=e[1],o=c;const h=P(o);let f,a;return e[2]!==h||e[3]!==n?(f=()=>{if(Number.isNaN(h)||(console.log({scrollToIndex:h,wordsContainer:n}),!n))return;const g=n.children[h];console.log({wordEl:g,wordsContainer:n}),g&&n.scrollTo({left:g.offsetLeft-n.clientWidth/2,behavior:"auto"})},a=[h,n],e[2]=h,e[3]=n,e[4]=f,e[5]=a):(f=e[4],a=e[5]),Z.useEffect(f,a),null},Xt=Z.memo(t=>{const e=ye.c(19),{lineAtom:r,lineIndex:n,type:o}=t,c=ae(be),u=P(r),[h,f]=Z.useState(!1),{t:a}=Qt();let g;e[0]!==c||e[1]!==u||e[2]!==n||e[3]!==o?(g=i=>{f(!1);const d=i.currentTarget.value;d!==u[o]&&c(L=>{L.lyricLines[n][o]=d})},e[0]=c,e[1]=u,e[2]=n,e[3]=o,e[4]=g):g=e[4];const S=g;let m,I;e[5]!==a||e[6]!==o?(I=o==="translatedLyric"?a("lyricLineView.translatedLabel","翻译："):a("lyricLineView.romanLabel","音译："),e[5]=a,e[6]=o,e[7]=I):I=e[7],m=I;const M=m;let N;e[8]!==M?(N=l.jsx(Ke,{size:"2",children:M}),e[8]=M,e[9]=N):N=e[9];let b;e[10]!==h||e[11]!==u||e[12]!==S||e[13]!==a||e[14]!==o?(b=h?l.jsx(lt,{autoFocus:!0,size:"1",defaultValue:u[o],onBlur:S,onKeyDown:i=>{i.key==="Enter"&&S(i)}}):l.jsx(At,{size:"2",color:"gray",variant:"ghost",onClick:i=>{i.stopPropagation(),f(!0)},children:u[o]||l.jsx(Ke,{color:"gray",children:a("lyricLineView.empty","无")})}),e[10]=h,e[11]=u,e[12]=S,e[13]=a,e[14]=o,e[15]=b):b=e[15];let p;return e[16]!==N||e[17]!==b?(p=l.jsxs(Me,{align:"baseline",children:[N,b]}),e[16]=N,e[17]=b,e[18]=p):p=e[18],p}),Vn=Z.memo(({lineAtom:t,lineIndex:e})=>{const r=P(t),n=ae(pe),o=Z.useMemo(()=>{const i=oe(d=>d(pe).has(r.id));return i.debugLabel="a",i.debugLabel="a",i},[r.id]),c=Z.useMemo(()=>er(oe(i=>i(t).words)),[t]),u=P(c),h=P(o),f=ae(fe),a=ae(be),g=P(Jt),S=P(ct),m=Je(),I=Z.useRef(null),M=Z.useRef(null),N=Z.useRef(null),[b,p]=Z.useState(!1);return Z.useEffect(()=>{if(!g)return;const i=M.current?.animate([{backgroundColor:"var(--green-a8)"},{backgroundColor:"var(--green-a4)"}],{duration:500});return()=>{i?.cancel()}},[r.startTime,g]),Z.useLayoutEffect(()=>{S!==re.Edit&&p(!1)},[S]),Z.useEffect(()=>{if(!g)return;const i=N.current?.animate([{backgroundColor:"var(--red-a8)"},{backgroundColor:"var(--red-a4)"}],{duration:500});return()=>{i?.cancel()}},[r.endTime,g]),l.jsxs(l.Fragment,{children:[l.jsx(Dn,{lineAtom:t,wordsContainer:I.current}),b&&l.jsx(At,{mx:"2",my:"1",variant:"soft",size:"1",style:{width:"calc(100% - var(--space-4))"},onClick:()=>{a(i=>{i.lyricLines.splice(e,0,$t())}),p(!1)},children:"在此插入新行"}),l.jsxs(at,{onOpenChange:i=>{i&&(m.get(pe).has(r.id)||m.set(pe,new Set([r.id])))},children:[l.jsx(dt,{disabled:S!==re.Edit,children:l.jsx(Me,{mx:"2",my:"1",direction:"row",className:Te(A.lyricLine,h&&A.selected,S===re.Sync&&A.sync,S===re.Edit&&A.edit,r.ignoreSync&&A.ignoreSync),align:"center",gapX:"4",draggable:S===re.Edit,onDragStart:i=>{i.dataTransfer.dropEffect="move",m.set(Ve,!0),m.set(Ne,r.id)},onDragEnd:()=>{m.set(Ve,!1)},onDragOver:i=>{if(!m.get(Ve)||m.get(Ne)===r.id||h)return;i.preventDefault(),i.dataTransfer.dropEffect="move";const d=i.currentTarget.getBoundingClientRect();i.clientY-d.top<d.height/2?(i.currentTarget.classList.add(A.dropTop),i.currentTarget.classList.remove(A.dropBottom)):(i.currentTarget.classList.remove(A.dropTop),i.currentTarget.classList.add(A.dropBottom))},onDrop:i=>{if(i.currentTarget.classList.remove(A.dropTop),i.currentTarget.classList.remove(A.dropBottom),!m.get(Ve))return;const d=i.currentTarget.getBoundingClientRect(),L=i.clientY-d.top,T=m.get(pe),W=T.has(m.get(Ne))?T:new Set([m.get(Ne)]);L<d.height/2?a(y=>{const v=y.lyricLines.filter(E=>!W.has(E.id)),R=y.lyricLines.filter(E=>W.has(E.id)),j=v.findIndex(E=>E.id===r.id);j<0||(y.lyricLines=[...v.slice(0,j),...R,...v.slice(j)])}):a(y=>{const v=y.lyricLines.filter(E=>!W.has(E.id)),R=y.lyricLines.filter(E=>W.has(E.id)),j=v.findIndex(E=>E.id===r.id);j<0||(y.lyricLines=[...v.slice(0,j+1),...R,...v.slice(j+2)])})},onDragLeave:i=>{i.currentTarget.classList.remove(A.dropTop),i.currentTarget.classList.remove(A.dropBottom)},onClick:i=>{i.stopPropagation(),i.preventDefault(),i.ctrlKey?n(d=>{d.has(r.id)?d.delete(r.id):d.add(r.id)}):i.shiftKey?n(d=>{if(d.size>0){let L=Number.NaN,T=Number.NaN;const W=m.get(be).lyricLines;W.forEach((y,v)=>{d.has(y.id)&&(Number.isNaN(L)&&(L=v),Number.isNaN(T)&&(T=v),L=Math.min(L,v,e),T=Math.max(T,v,e))});for(let y=L;y<=T;y++)d.add(W[y].id)}else d.add(r.id)}):(n(d=>{(!d.has(r.id)||d.size!==1)&&(d.clear(),d.add(r.id))}),f(d=>{d.size!==0&&d.clear()}))},asChild:!0,children:l.jsxs("div",{children:[l.jsxs(Me,{direction:"column",align:"center",justify:"center",ml:"3",children:[l.jsx(Ke,{style:{minWidth:"2em"},align:"center",color:"gray",children:e}),r.isBG&&l.jsx(_r,{color:"#4466FF"}),r.isDuet&&l.jsx(Er,{color:"#44AA33"})]}),l.jsxs("div",{className:Te(A.lyricLineContainer,S===re.Edit&&A.edit,S===re.Sync&&A.sync),children:[l.jsxs("div",{className:Te(A.lyricWordsContainer,S===re.Edit&&A.edit,S===re.Sync&&A.sync),ref:I,children:[u.map((i,d)=>l.jsxs(Z.Fragment,{children:[b&&l.jsx(Ye,{size:"1",variant:"soft",onClick:L=>{L.preventDefault(),L.stopPropagation(),a(T=>{T.lyricLines[e].words.splice(d,0,st())})},children:l.jsx(Tt,{})}),l.jsx(Mn,{wordAtom:i,wordIndex:d,line:r,lineIndex:e})]},`word-${d}`)),b&&l.jsx(Ye,{size:"1",variant:"soft",onClick:i=>{i.preventDefault(),i.stopPropagation(),a(d=>{d.lyricLines[e].words.push(st())})},children:l.jsx(Tt,{})}),S===re.Edit&&l.jsx(lt,{placeholder:"插入单词…",className:Te(A.insertWordField,u.length===0&&A.empty),style:{alignSelf:"center"},onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),i.stopPropagation(),a(d=>{d.lyricLines[e].words.push({...st(),word:i.currentTarget.value})}),i.currentTarget.value="")}})]}),S===re.Edit&&l.jsxs(l.Fragment,{children:[l.jsx(Xt,{lineAtom:t,lineIndex:e,type:"translatedLyric"}),l.jsx(Xt,{lineAtom:t,lineIndex:e,type:"romanLyric"})]})]}),S===re.Edit&&l.jsx(Me,{p:"3",children:l.jsx(Ye,{size:"1",variant:b?"solid":"soft",onClick:i=>{i.preventDefault(),i.stopPropagation(),p(d=>!d)},children:l.jsx(Tt,{})})}),S===re.Sync&&l.jsxs(Me,{pr:"3",gap:"1",direction:"column",align:"stretch",children:[l.jsx("div",{className:A.startTime,ref:M,children:ke(r.startTime)}),l.jsx("div",{className:A.endTime,ref:N,children:ke(r.endTime)})]})]})})}),l.jsx(ft,{children:l.jsx(ht,{lineIndex:e})})]}),b&&l.jsx(At,{mx:"2",my:"1",variant:"soft",size:"1",style:{width:"calc(100% - var(--space-4))"},onClick:()=>{a(i=>{i.lyricLines.splice(e+1,0,$t())}),p(!1)},children:"在此插入新行"})]})});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Dt=globalThis.jotaiAtomCache.get("D:\\github project\\新建文件夹\\amll-ttml-tool\\src\\components\\LyricLinesView\\index.tsx/lyricLinesOnlyAtom",er(cn(be,t=>t.prop("lyricLines"))));Dt.debugLabel="lyricLinesOnlyAtom";Dt.debugLabel="lyricLinesOnlyAtom";const zn=Z.forwardRef((t,e)=>{const r=P(Dt),n=Z.useRef(null),o=Z.useRef(null),c=P(ct),u=Z.useMemo(()=>oe(f=>{if(c!==re.Sync)return;const a=o.current;if(!a||!a.parentElement)return;const S=f(pe);let m=Number.NaN,I=0;for(const M of r){const N=f(M);if(S.has(N.id)){m=I;break}I++}if(!Number.isNaN(m))return m}),[r,c]),h=P(u);return Z.useEffect(()=>{if(h===void 0)return;const f=o.current;if(!f)return;const a=f.parentElement;a&&n.current?.scrollToIndex({index:h,offset:a.clientHeight/-2+50})},[h]),Z.useImperativeHandle(e,()=>o.current,[]),r.length===0?l.jsxs(Me,{flexGrow:"1",gap:"2",align:"center",justify:"center",direction:"column",height:"100%",ref:e,children:[l.jsx(Ke,{color:"gray",children:"没有歌词行"}),l.jsx(Ke,{color:"gray",children:"在顶部面板中添加新歌词行或从菜单栏打开 / 导入已有歌词"})]}):l.jsx(vr,{flexGrow:"1",style:{padding:c===re.Sync?"20vh 0":void 0,maxHeight:"100%",overflowY:"auto"},ref:o,children:l.jsx(an.ViewportList,{overscan:10,items:r,ref:n,viewportRef:o,children:(f,a)=>l.jsx(Vn,{lineAtom:f,lineIndex:a},`${f}`)})})});export{zn as LyricLinesView,zn as default};
//# sourceMappingURL=index-Dz3dSt6I.js.map
